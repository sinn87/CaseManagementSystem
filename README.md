# CaseManagementSystem - 案件详细录入功能

## 项目概述

CaseManagementSystem 是一个基于VB.NET开发的案件管理系统，实现了案件详细录入功能，用户可以选择案件类型后进入详细录入页面，分9个TabPage录入案件详细信息，并支持数据保存。

## 功能概述

本系统实现了案件详细录入功能，用户可以选择案件类型后进入详细录入页面，分9个TabPage录入案件详细信息，并支持数据保存。

## 实现的功能

### 1. 数据保存规则
- 标签页里至少有一个值被修改（或发生变化），保存这一页所有的tag的数据
- 有值的保存新值，无值的保存null，并且状态登录为"新登录"
- 有修改的标签页批量保存，并且更新审查记录表，插入标签页编号，状态为"新登录"

### 2. 技术架构
遵循三层架构设计：
- **UI层（窗体）**：负责显示界面、响应用户操作
- **业务逻辑层（BLL）**：处理业务流程逻辑、控制数据调用
- **数据访问层（DAL）**：直接访问数据库

### 3. 核心类说明

#### 模型层（Models）
- `CaseInfo.vb` - 案件信息实体
- `CaseDetail.vb` - 案件详细信息实体  
- `ReviewLog.vb` - 审查记录实体

#### 数据访问层（DataAccess）
- `DbHelper.vb` - 数据库操作辅助类
- `CaseRepository.vb` - 案件数据访问层

#### 业务逻辑层（BusinessLogic）
- `CaseManager.vb` - 案件管理业务逻辑

#### 界面层（Forms）
- `LoginForm.vb` - 登录窗体
- `MainForm.vb` - 主窗体
- `CaseTypeSelectForm.vb` - 案件类型选择窗体
- `CaseDetailEntryForm.vb` - 案件详细录入窗体

## 使用流程

1. **登录系统**：输入员工番号和密码
2. **选择功能**：在主页面点击"登录新案件"
3. **选择类型**：选择案件类型（PO/IPO/RPO/RIPO）
4. **详细录入**：在9个标签页中录入详细信息
5. **保存数据**：点击"登录新案件"按钮保存

## 数据库设计

### 主要表结构
- **Cases** - 案件主表
- **CaseDetails** - 案件详细表
- **ReviewLogs** - 审查记录表
- **Users** - 用户表

### 关键字段
- 控件Tag属性与数据库字段一一对应
- 支持多种控件类型：TextBox、ComboBox、CheckBox、DateTimePicker等

## 技术特点

1. **参数化查询**：防止SQL注入
2. **异常处理**：完善的错误处理和日志记录
3. **数据验证**：保存前检查数据有效性
4. **用户友好**：清晰的界面提示和操作反馈

## 注意事项

1. 需要配置正确的数据库连接字符串
2. 确保数据库表结构已创建
3. 控件Tag属性必须与数据库字段对应
4. 建议在正式使用前进行充分测试

## 扩展建议

1. 添加数据验证规则
2. 实现数据导入导出功能
3. 添加权限控制
4. 优化界面布局和用户体验 